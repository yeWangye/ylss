<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<style type="text/css">
			html,
			body {
				overflow: hidden;
				margin: 0;
			}
			
			#allmap {
				position: relative;
				width: 100%;
				overflow: hidden;
				height: 100px;
				margin: 0;
				font-family: "微软雅黑";
				transition: height 1s;
				-moz-transition: height 1s;
				-webkit-transition: height 1s;
				-o-transition: height 1s;
			}
		</style>
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=h7FmYfal3X1emsR59G29XPXbACQGhyw4"></script>
		<title>浏览器定位</title>
	</head>

	<body>
		<div id="allmap">

		</div>

	</body>

</html>
<script type="text/javascript">
	window.onload = function() {

	}
	var map = new BMap.Map("allmap");
	var point = new BMap.Point(116, 40);
	map.centerAndZoom(point, 18);
	var geolocation = new BMap.Geolocation();
	var rPoint = null;
	var mkTemp = null;
	drawMap();

	function drawMap() {
		// 百度地图API功能
		if(rPoint) {
			map.addOverlay(mkTemp);
			map.panTo(rPoint);
		} else {
			geolocation.getCurrentPosition(function(r) {
				if(this.getStatus() == BMAP_STATUS_SUCCESS) {
					var mk = new BMap.Marker(r.point);
					map.addOverlay(mk);
					map.panTo(r.point);
					rPoint = r.point;
					mkTemp = mk;
				} else {
					alert('failed' + this.getStatus());
				}
			}, {
				enableHighAccuracy: true
			})
		}

	}

	function setMap(num) {
		document.getElementById("allmap").style.height = num + "px";
		//		document.getElementById("allmap").style.transform = 'scale(1,2)';

		setTimeout("drawMap()", 1000)

	}
	//关于状态码
	//BMAP_STATUS_SUCCESS	检索成功。对应数值“0”。
	//BMAP_STATUS_CITY_LIST	城市列表。对应数值“1”。
	//BMAP_STATUS_UNKNOWN_LOCATION	位置结果未知。对应数值“2”。
	//BMAP_STATUS_UNKNOWN_ROUTE	导航结果未知。对应数值“3”。
	//BMAP_STATUS_INVALID_KEY	非法密钥。对应数值“4”。
	//BMAP_STATUS_INVALID_REQUEST	非法请求。对应数值“5”。
	//BMAP_STATUS_PERMISSION_DENIED	没有权限。对应数值“6”。(自 1.1 新增)
	//BMAP_STATUS_SERVICE_UNAVAILABLE	服务不可用。对应数值“7”。(自 1.1 新增)
	//BMAP_STATUS_TIMEOUT	超时。对应数值“8”。(自 1.1 新增)
</script>